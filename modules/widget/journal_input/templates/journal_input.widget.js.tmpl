Widget.types.journal_input = {
	prepare: function() {
		this.reload();
		Widget.handle('rapila-journals_changed', this.reload.bind(this));		
	},
	
	reload: function() {
		var current = this._element.val();
		this._element.empty();
		if(this.settings.initial_selection !== null) {
			this._element.populate({'': "{{writeString=wns.choose}}"});
		}
		this._element.populate(this.getJournals(this.settings.journal_ids_configured));
		if(current) {
			this.val(current);
		} 
	},
	
	val: function(value) {
		if(value) {
			this._element.val(value);
			return;
		}
		return this._element.val();
	},
	
	settings: {
		journal_ids_configured: null,
		initial_selection: null
	}
};